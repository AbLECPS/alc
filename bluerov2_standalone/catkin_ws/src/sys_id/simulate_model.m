function xp = simulate_model(x,u,stepSize)

% states
% x(1): x position 
% x(2): y position
% x(3): vehicle heading

% u(1) is heading-change
% u(2) is speed
% matrices = 
% A = [-0.000313916490540, 0.001061150070239, -3.348005730889027; 
%       0.000039638097361, -0.000135859890048, -0.376038617601684;
%       0.000001532345552,  -0.000006491609986,  -0.538081047764798];
% 
% B = [0.050281804725666, 0.861318274378801;
%     0.017881793171043,  0.448247665566177;
%    0.009425493250813,   0.012325243536305];


A = [0.000110934757707122,	0.0176481545263511,	-0.361993031166798;
0.000113111902385930,	0.00162986090236893, 1.63321898403585;
2.82185649873063e-05,	-1.75925433470232e-05,	0.645980176182907];


B =[ 0.00588416436363635, 0.536394967123741;
-0.0240381022203886, 0.555059923037031;
-0.0112500920603916, 0.227799073448295];

inner_state= [x(1);x(2);x(3)];
control = [u(1);u(2)];
dx = A* inner_state + B*control;
xp = (stepSize * dx) + inner_state;
end